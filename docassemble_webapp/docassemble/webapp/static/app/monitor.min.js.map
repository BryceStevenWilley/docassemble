{"version":3,"sources":["docassemble_webapp/docassemble/webapp/static/app/monitor.js"],"sourcesContent":["var $;\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n  if (typeof $ == \"undefined\") {\n    $ = jQuery.noConflict();\n  }\n  $(document).ready(daReadyFunction);\n});\n\nvar daAudioContext = null;\nvar daSocket;\nvar daSoundBuffer = Object();\nvar daShowingNotif = false;\nvar daUpdatedSessions = Object();\nvar daSessions = Object();\nvar daAvailRoles = Object();\nvar daChatPartners = Object();\nvar daPhonePartners = Object();\nvar daNewPhonePartners = Object();\nvar daTermPhonePartners = Object();\nvar daFirstTime = 1;\nvar daUpdateMonitorInterval = null;\nvar daNotificationsEnabled = false;\nvar daControlling = Object();\nwindow.daGotConfirmation = function (key) {\n  //console.log(\"Got confirmation in parent for key \" + key);\n  // daControlling[key] = 2;\n  // var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/)/g, '\\\\$1');\n  // $(\"#listelement\" + skey).find(\"a\").each(function(){\n  //     if ($(this).data('name') == \"stopcontrolling\"){\n  //         $(this).removeClass('dainvisible');\n  //         console.log(\"Found it\");\n  //     }\n  // });\n};\nfunction daFaviconRegular() {\n  var link =\n    document.querySelector(\"link[rel*='shortcut icon'\") ||\n    document.createElement(\"link\");\n  link.type = \"image/x-icon\";\n  link.rel = \"shortcut icon\";\n  link.href = daFaviconIcoUrl;\n  document.getElementsByTagName(\"head\")[0].appendChild(link);\n}\nfunction daFaviconAlert() {\n  var link =\n    document.querySelector(\"link[rel*='shortcut icon'\") ||\n    document.createElement(\"link\");\n  link.type = \"image/x-icon\";\n  link.rel = \"shortcut icon\";\n  link.href = daChatIcoUrl;\n  document.getElementsByTagName(\"head\")[0].appendChild(link);\n}\nfunction daTopMessage(message) {\n  var newDiv = document.createElement(\"div\");\n  $(newDiv).addClass(\n    \"datop-alert col-xs-10 col-sm-7 col-md-6 col-lg-5 dacol-centered\",\n  );\n  $(newDiv).html(message);\n  $(newDiv).css(\"display\", \"none\");\n  $(newDiv).appendTo($(daTargetDiv));\n  $(newDiv).slideDown();\n  setTimeout(function () {\n    $(newDiv).slideUp(300, function () {\n      $(newDiv).remove();\n    });\n  }, 2000);\n}\nwindow.daAbortControlling = function (key) {\n  daTopMessage(daAlreadyControlled);\n  daStopControlling(key);\n};\nwindow.daStopControlling = function (key) {\n  //console.log(\"Got daStopControlling in parent for key \" + key);\n  // if (daControlling.hasOwnProperty(key)){\n  //   delete daControlling[key];\n  // }\n  var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/)/g, \"\\\\$1\");\n  $(\"#listelement\" + skey)\n    .find(\"a\")\n    .each(function () {\n      if ($(this).data(\"name\") == \"stopcontrolling\") {\n        $(this).click();\n        //console.log(\"Found it\");\n      }\n    });\n};\nfunction daOnError() {\n  console.log(\"daOnError\");\n}\nfunction daLoadSoundBuffer(key, url_a, url_b) {\n  //console.log(\"daLoadSoundBuffer\");\n  var pos = 0;\n  if (daAudioContext == null) {\n    return;\n  }\n  var request = new XMLHttpRequest();\n  request.open(\"GET\", url_a, true);\n  request.responseType = \"arraybuffer\";\n  request.onload = function () {\n    daAudioContext.decodeAudioData(\n      request.response,\n      function (buffer) {\n        if (!buffer) {\n          if (pos == 1) {\n            console.error(\"daLoadSoundBuffer: error decoding file data\");\n            return;\n          } else {\n            pos = 1;\n            console.info(\n              \"daLoadSoundBuffer: error decoding file data, trying next source\",\n            );\n            request.open(\"GET\", url_b, true);\n            return request.send();\n          }\n        }\n        daSoundBuffer[key] = buffer;\n      },\n      function (error) {\n        if (pos == 1) {\n          console.error(\"daLoadSoundBuffer: decodeAudioData error\");\n          return;\n        } else {\n          pos = 1;\n          console.info(\n            \"daLoadSoundBuffer: decodeAudioData error, trying next source\",\n          );\n          request.open(\"GET\", url_b, true);\n          return request.send();\n        }\n      },\n    );\n  };\n  request.send();\n}\nfunction daPlaySound(key) {\n  //console.log(\"daPlaySound\");\n  var buffer = daSoundBuffer[key];\n  if (!daAudioContext || !buffer) {\n    return;\n  }\n  var source = daAudioContext.createBufferSource();\n  source.buffer = buffer;\n  source.connect(daAudioContext.destination);\n  source.start(0);\n}\nfunction daCheckNotifications() {\n  //console.log(\"daCheckNotifications\");\n  if (daNotificationsEnabled) {\n    return;\n  }\n  if (!(\"Notification\" in window)) {\n    daNotificationsEnabled = false;\n    return;\n  }\n  if (Notification.permission === \"granted\") {\n    daNotificationsEnabled = true;\n    return;\n  }\n  if (Notification.permission !== \"denied\") {\n    Notification.requestPermission(function (permission) {\n      if (permission === \"granted\") {\n        daNotificationsEnabled = true;\n      }\n    });\n  }\n}\nfunction daNotifyOperator(key, mode, message) {\n  //console.log(\"daNotifyOperator: \" + key + \" \" + mode + \" \" + message);\n  var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/)/g, \"\\\\$1\");\n  if (mode == \"chat\") {\n    daPlaySound(\"newmessage\");\n  } else {\n    daPlaySound(\"newconversation\");\n  }\n  if (\n    $(\"#listelement\" + skey).offset().top >\n    $(window).scrollTop() + $(window).height()\n  ) {\n    if (mode == \"chat\") {\n      $(\"#chat-message-below\").html(daNewMessageBelow);\n    } else {\n      $(\"#chat-message-below\").html(daNewConversationBelow);\n    }\n    //$(\"#chat-message-below\").data('key', key);\n    $(\"#chat-message-below\").slideDown();\n    daShowingNotif = true;\n    daMarkAsUpdated(key);\n  } else if (\n    $(\"#listelement\" + skey).offset().top + $(\"#listelement\" + skey).height() <\n    $(window).scrollTop() + 32\n  ) {\n    if (mode == \"chat\") {\n      $(\"#chat-message-above\").html(daNewMessageAbove);\n    } else {\n      $(\"#chat-message-above\").html(daNewConversationAbove);\n    }\n    //$(\"#chat-message-above\").data('key', key);\n    $(\"#chat-message-above\").slideDown();\n    daShowingNotif = true;\n    daMarkAsUpdated(key);\n  } else {\n    //console.log(\"It is visible\");\n  }\n  if (!daNotificationsEnabled) {\n    //console.log(\"Browser will not enable notifications\")\n    return;\n  }\n  if (!(\"Notification\" in window)) {\n    return;\n  }\n  if (Notification.permission === \"granted\") {\n    var notification = new Notification(message);\n  } else if (Notification.permission !== \"denied\") {\n    Notification.requestPermission(function (permission) {\n      if (permission === \"granted\") {\n        var notification = new Notification(message);\n        daNotificationsEnabled = true;\n      }\n    });\n  }\n}\nfunction daPhoneNumberOk() {\n  //console.log(\"daPhoneNumberOk\");\n  var phoneNumber = $(\"#daPhoneNumber\").val();\n  if (phoneNumber == \"\" || phoneNumber.match(/^\\+?[1-9]\\d{1,14}$/)) {\n    return true;\n  } else {\n    return false;\n  }\n}\nfunction daCheckPhone() {\n  //console.log(\"daCheckPhone\");\n  $(\"#daPhoneNumber\").val($(\"#daPhoneNumber\").val().replace(/ \\-/g, \"\"));\n  var the_number = $(\"#daPhoneNumber\").val();\n  if (the_number != \"\" && the_number[0] != \"+\") {\n    $(\"#daPhoneNumber\").val(\"+\" + the_number);\n  }\n  if (daPhoneNumberOk()) {\n    $(\"#daPhoneNumber\").removeClass(\"is-invalid\");\n    $(\"#daPhoneError\").addClass(\"dainvisible\");\n    daPhoneNumber = $(\"#daPhoneNumber\").val();\n    if (daPhoneNumber == \"\") {\n      daPhoneNumber = null;\n    } else {\n      $(\".phone\").removeClass(\"dainvisible\");\n    }\n    $(\"#daPhoneSaved\").removeClass(\"dainvisible\");\n    setTimeout(function () {\n      $(\"#daPhoneSaved\").addClass(\"dainvisible\");\n    }, 2000);\n  } else {\n    $(\"#daPhoneNumber\").addClass(\"is-invalid\");\n    $(\"#daPhoneError\").removeClass(\"dainvisible\");\n    daPhoneNumber = null;\n    $(\".phone\").addClass(\"dainvisible\");\n  }\n}\nfunction daAllSessions(uid, yaml_filename) {\n  //console.log(\"daAllSessions\");\n  var prefix = \"da:session:uid:\" + uid + \":i:\" + yaml_filename + \":userid:\";\n  var output = Array();\n  for (var key in daSessions) {\n    if (daSessions.hasOwnProperty(key) && key.indexOf(prefix) == 0) {\n      output.push(key);\n    }\n  }\n  return output;\n}\nfunction daScrollChat(key) {\n  var chatScroller = $(key).find(\"ul\").first();\n  if (chatScroller.length) {\n    var height = chatScroller[0].scrollHeight;\n    chatScroller.animate({ scrollTop: height }, 800);\n  } else {\n    console.log(\"daScrollChat: error\");\n  }\n}\nfunction daScrollChatFast(key) {\n  var chatScroller = $(key).find(\"ul\").first();\n  if (chatScroller.length) {\n    var height = chatScroller[0].scrollHeight;\n    //console.log(\"Scrolling to \" + height + \" where there are \" + chatScroller[0].childElementCount + \" children\");\n    chatScroller.scrollTop(height);\n  } else {\n    console.log(\"daScrollChatFast: error\");\n  }\n}\nfunction daDoUpdateMonitor() {\n  //console.log(\"daDoUpdateMonitor with \" + daAvailableForChat);\n  if (daPhoneNumberOk()) {\n    daPhoneNumber = $(\"#daPhoneNumber\").val();\n    if (daPhoneNumber == \"\") {\n      daPhoneNumber = null;\n    }\n  } else {\n    daPhoneNumber = null;\n  }\n  daSocket.emit(\"updatemonitor\", {\n    available_for_chat: daAvailableForChat,\n    phone_number: daPhoneNumber,\n    subscribed_roles: daSubscribedRoles,\n    phone_partners_to_add: daNewPhonePartners,\n    phone_partners_to_terminate: daTermPhonePartners,\n  });\n}\nfunction daUpdateMonitor() {\n  //console.log(\"daUpdateMonitor with \" + daAvailableForChat);\n  if (daUpdateMonitorInterval != null) {\n    clearInterval(daUpdateMonitorInterval);\n  }\n  daDoUpdateMonitor();\n  daUpdateMonitorInterval = setInterval(daDoUpdateMonitor, daCheckinInterval);\n  //console.log(\"daUpdateMonitor\");\n}\nfunction daIsHidden(ref) {\n  if ($(ref).length) {\n    if ($(ref).offset().top + $(ref).height() < $(window).scrollTop() + 32) {\n      return -1;\n    } else if (\n      $(ref).offset().top >\n      $(window).scrollTop() + $(window).height()\n    ) {\n      return 1;\n    } else {\n      return 0;\n    }\n  } else {\n    return 0;\n  }\n}\nfunction daMarkAsUpdated(key) {\n  //console.log(\"daMarkAsUpdated with \" + key);\n  var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/)/g, \"\\\\$1\");\n  if (daIsHidden(\"#listelement\" + skey)) {\n    daUpdatedSessions[\"#listelement\" + skey] = 1;\n  }\n}\nfunction daActivateChatArea(key) {\n  //console.log(\"daActivateChatArea with \" + key);\n  var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/)/g, \"\\\\$1\");\n  if (\n    !$(\"#chatarea\" + skey)\n      .find(\"input\")\n      .first()\n      .is(\":focus\")\n  ) {\n    $(\"#listelement\" + skey).addClass(\"da-new-message\");\n    if (daBrowserTitle == document.title) {\n      document.title = \"* \" + daBrowserTitle;\n      daFaviconAlert();\n    }\n  }\n  daMarkAsUpdated(key);\n  $(\"#chatarea\" + skey).removeClass(\"dainvisible\");\n  $(\"#chatarea\" + skey)\n    .find(\"input, button\")\n    .prop(\"disabled\", false);\n  $(\"#chatarea\" + skey)\n    .find(\"ul\")\n    .html(\"\");\n  daSocket.emit(\"chat_log\", { key: key });\n}\nfunction daDeActivateChatArea(key) {\n  //console.log(\"daActivateChatArea with \" + key);\n  var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/)/g, \"\\\\$1\");\n  $(\"#chatarea\" + skey)\n    .find(\"input, button\")\n    .prop(\"disabled\", true);\n  $(\"#listelement\" + skey).removeClass(\"da-new-message\");\n  if (document.title != daBrowserTitle) {\n    document.title = daBrowserTitle;\n    daFaviconRegular();\n  }\n}\nfunction daUndrawSession(key) {\n  //console.log(\"Undrawing...\");\n  var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/)/g, \"\\\\$1\");\n  var xButton = document.createElement(\"a\");\n  var xButtonIcon = document.createElement(\"i\");\n  $(xButton).addClass(\"dacorner-remove\");\n  $(xButtonIcon).addClass(\"fa-solid fa-times-circle\");\n  $(xButtonIcon).appendTo($(xButton));\n  $(\"#listelement\" + skey).addClass(\"list-group-item-danger\");\n  $(\"#session\" + skey)\n    .find(\"a\")\n    .remove();\n  $(\"#session\" + skey)\n    .find(\"span\")\n    .first()\n    .html(daOfflineWord);\n  $(\"#session\" + skey)\n    .find(\"span\")\n    .first()\n    .removeClass(daButtonStyle + \"info\");\n  $(\"#session\" + skey)\n    .find(\"span\")\n    .first()\n    .addClass(daButtonStyle + \"danger\");\n  $(xButton).click(function () {\n    $(\"#listelement\" + skey).slideUp(300, function () {\n      $(\"#listelement\" + skey).remove();\n      daCheckIfEmpty();\n    });\n  });\n  $(xButton).appendTo($(\"#session\" + skey));\n  $(\"#chatarea\" + skey)\n    .find(\"input, button\")\n    .prop(\"disabled\", true);\n  var theIframe = $(\"#iframe\" + skey).find(\"iframe\")[0];\n  if (theIframe) {\n    $(theIframe).contents().find(\"body\").addClass(\"dainactive\");\n    if (theIframe.contentWindow && theIframe.contentWindow.daTurnOffControl) {\n      theIframe.contentWindow.daTurnOffControl();\n    }\n  }\n  if (daControlling.hasOwnProperty(key)) {\n    delete daControlling[key];\n  }\n  delete daSessions[key];\n}\nfunction daPublishChatLog(uid, yaml_filename, userid, mode, messages, scroll) {\n  //console.log(\"daPublishChatLog with \" + uid + \" \" + yaml_filename + \" \" + userid + \" \" + mode + \" \" + messages);\n  //console.log(\"daPublishChatLog: scroll is \" + scroll);\n  var keys;\n  //if (mode == 'peer' || mode == 'peerhelp'){\n  //    keys = daAllSessions(uid, yaml_filename);\n  //}\n  //else{\n  keys = [\n    \"da:session:uid:\" + uid + \":i:\" + yaml_filename + \":userid:\" + userid,\n  ];\n  //}\n  for (var i = 0; i < keys.length; ++i) {\n    key = keys[i];\n    var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/)/g, \"\\\\$1\");\n    var chatArea = $(\"#chatarea\" + skey)\n      .find(\"ul\")\n      .first();\n    if (messages.length > 0) {\n      $(chatArea).removeClass(\"dainvisible\");\n    }\n    for (var i = 0; i < messages.length; ++i) {\n      var message = messages[i];\n      var newLi = document.createElement(\"li\");\n      $(newLi).addClass(\"list-group-item\");\n      if (message.is_self) {\n        $(newLi).addClass(\"list-group-item-primary dalistright\");\n      } else {\n        $(newLi).addClass(\"list-group-item-secondary dalistleft\");\n      }\n      $(newLi).html(message.message);\n      $(newLi).appendTo(chatArea);\n    }\n    if (messages.length > 0 && scroll) {\n      daScrollChatFast(\"#chatarea\" + skey);\n    }\n  }\n}\nfunction daCheckIfEmpty() {\n  if ($(\"#monitorsessions\").find(\"li\").length > 0) {\n    $(\"#emptylist\").addClass(\"dainvisible\");\n  } else {\n    $(\"#emptylist\").removeClass(\"dainvisible\");\n  }\n}\nfunction daDrawSession(key, obj) {\n  //console.log(\"daDrawSession with \" + key);\n  var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/)/g, \"\\\\$1\");\n  var the_html;\n  var wants_to_chat;\n  if (obj.chatstatus != \"off\") {\n    wants_to_chat = true;\n  }\n  if (wants_to_chat) {\n    the_html = obj.browser_title + \" &mdash; \";\n    if (obj.hasOwnProperty(\"first_name\")) {\n      the_html += obj.first_name + \" \" + obj.last_name;\n    } else {\n      the_html += daAnonymousVisitor + \" \" + obj.temp_user_id;\n    }\n  }\n  var theListElement;\n  var sessionDiv;\n  var theIframeContainer;\n  var theChatArea;\n  if ($(\"#session\" + skey).length && !(key in daSessions)) {\n    $(\"#listelement\" + skey).removeClass(\"list-group-item-danger\");\n    $(\"#iframe\" + skey)\n      .find(\"iframe\")\n      .first()\n      .contents()\n      .find(\"body\")\n      .removeClass(\"dainactive\");\n  }\n  daSessions[key] = 1;\n  if ($(\"#session\" + skey).length) {\n    theListElement = $(\"#listelement\" + skey).first();\n    sessionDiv = $(\"#session\" + skey).first();\n    //controlDiv = $(\"#control\" + skey).first();\n    theIframeContainer = $(\"#iframe\" + skey).first();\n    theChatArea = $(\"#chatarea\" + skey).first();\n    $(sessionDiv).empty();\n    if (\n      obj.chatstatus == \"on\" &&\n      key in daChatPartners &&\n      $(\"#chatarea\" + skey)\n        .find(\"button\")\n        .first()\n        .prop(\"disabled\") == true\n    ) {\n      daActivateChatArea(key);\n    }\n  } else {\n    var theListElement = document.createElement(\"li\");\n    $(theListElement).addClass(\"list-group-item\");\n    $(theListElement).attr(\"id\", \"listelement\" + key);\n    var sessionDiv = document.createElement(\"div\");\n    $(sessionDiv).attr(\"id\", \"session\" + key);\n    $(sessionDiv).addClass(\"da-chat-session\");\n    $(sessionDiv).addClass(\"p-1\");\n    $(sessionDiv).appendTo($(theListElement));\n    $(theListElement).appendTo(\"#monitorsessions\");\n    // controlDiv = document.createElement('div');\n    // $(controlDiv).attr('id', \"control\" + key);\n    // $(controlDiv).addClass(\"dachatcontrol dainvisible da-chat-session\");\n    // $(controlDiv).appendTo($(theListElement));\n    theIframeContainer = document.createElement(\"div\");\n    $(theIframeContainer).addClass(\"daobserver-container dainvisible\");\n    $(theIframeContainer).attr(\"id\", \"iframe\" + key);\n    var theIframe = document.createElement(\"iframe\");\n    $(theIframe).addClass(\"daobserver\");\n    $(theIframe).attr(\"name\", \"iframe\" + key);\n    $(theIframe).appendTo($(theIframeContainer));\n    $(theIframeContainer).appendTo($(theListElement));\n    var theChatArea = document.createElement(\"div\");\n    $(theChatArea).addClass(\"monitor-chat-area dainvisible\");\n    $(theChatArea).html(\n      '<div class=\"row\"><div class=\"col-md-12\"><ul class=\"list-group dachatbox\" id=\"daCorrespondence\"></ul></div></div><form autocomplete=\"off\"><div class=\"row\"><div class=\"col-md-12\"><div class=\"input-group\"><input type=\"text\" class=\"form-control daChatMessage\" disabled=\"\"><button role=\"button\" class=\"btn \" + daButtonStyle + \"secondary daChatButton\" type=\"button\" disabled=\"\">' +\n        daSendWord +\n        \"</button></div></div></div></form>\",\n    );\n    $(theChatArea).attr(\"id\", \"chatarea\" + key);\n    var submitter = function () {\n      //console.log(\"I am the submitter and I am submitting \" + key);\n      var input = $(theChatArea).find(\"input\").first();\n      var message = input.val().trim();\n      if (message == null || message == \"\") {\n        //console.log(\"Message was blank\");\n        return false;\n      }\n      daSocket.emit(\"chatmessage\", { key: key, data: input.val() });\n      input.val(\"\");\n      return false;\n    };\n    $(theChatArea).find(\"button\").click(submitter);\n    $(theChatArea)\n      .find(\"input\")\n      .bind(\"keypress keydown keyup\", function (e) {\n        var theCode = e.which || e.keyCode;\n        if (theCode == 13) {\n          submitter();\n          e.preventDefault();\n        }\n      });\n    $(theChatArea)\n      .find(\"input\")\n      .focus(function () {\n        $(theListElement).removeClass(\"da-new-message\");\n        if (document.title != daBrowserTitle) {\n          document.title = daBrowserTitle;\n          daFaviconRegular();\n        }\n      });\n    $(theChatArea).appendTo($(theListElement));\n    if (obj.chatstatus == \"on\" && key in daChatPartners) {\n      daActivateChatArea(key);\n    }\n  }\n  var theText = document.createElement(\"span\");\n  $(theText).addClass(\"da-chat-title-label\");\n  theText.innerHTML = the_html;\n  var statusLabel = document.createElement(\"span\");\n  $(statusLabel).addClass(\"badge bg-info da-chat-status-label\");\n  $(statusLabel).html(obj.chatstatus == \"observeonly\" ? \"off\" : obj.chatstatus);\n  $(statusLabel).appendTo($(sessionDiv));\n  if (daUsePhone) {\n    var phoneButton = document.createElement(\"a\");\n    var phoneIcon = document.createElement(\"i\");\n    $(phoneIcon).addClass(\"fa-solid fa-phone\");\n    $(phoneIcon).appendTo($(phoneButton));\n    $(phoneButton).addClass(\"btn phone\");\n    $(phoneButton).data(\"name\", \"phone\");\n    if (key in daPhonePartners) {\n      $(phoneButton).addClass(\"phone-on \" + daButtonStyle + \"success\");\n      $(phoneButton).attr(\"title\", daPhoneOnMessage);\n    } else {\n      $(phoneButton).addClass(\"phone-off \" + daButtonStyle + \"secondary\");\n      $(phoneButton).attr(\"title\", daPhoneOffMessage);\n    }\n    $(phoneButton).attr(\"tabindex\", 0);\n    $(phoneButton).addClass(\"daobservebutton\");\n    $(phoneButton).appendTo($(sessionDiv));\n    $(phoneButton).attr(\"href\", \"#\");\n    if (daPhoneNumber == null) {\n      $(phoneButton).addClass(\"dainvisible\");\n    }\n    $(phoneButton).click(function (e) {\n      e.preventDefault();\n      if ($(this).hasClass(\"phone-off\") && daPhoneNumber != null) {\n        $(this).removeClass(\"phone-off\");\n        $(this).removeClass(daButtonStyle + \"secondary\");\n        $(this).addClass(\"phone-on\");\n        $(this).addClass(daButtonStyle + \"success\");\n        $(this).attr(\"title\", daPhoneOnMessage);\n        daPhonePartners[key] = 1;\n        daNewPhonePartners[key] = 1;\n        if (key in daTermPhonePartners) {\n          delete daTermPhonePartners[key];\n        }\n      } else {\n        $(this).removeClass(\"phone-on\");\n        $(this).removeClass(daButtonStyle + \"success\");\n        $(this).addClass(\"phone-off\");\n        $(this).addClass(daButtonStyle + \"secondary\");\n        $(this).attr(\"title\", daPhoneOffMessage);\n        if (key in daPhonePartners) {\n          delete daPhonePartners[key];\n        }\n        if (key in daNewPhonePartners) {\n          delete daNewPhonePartners[key];\n        }\n        daTermPhonePartners[key] = 1;\n      }\n      daUpdateMonitor();\n      return false;\n    });\n  }\n  var unblockButton = document.createElement(\"a\");\n  $(unblockButton).addClass(\"btn \" + daButtonStyle + \"info daobservebutton\");\n  $(unblockButton).data(\"name\", \"unblock\");\n  if (!obj.blocked) {\n    $(unblockButton).addClass(\"dainvisible\");\n  }\n  $(unblockButton).html(daUnblockWord);\n  $(unblockButton).attr(\"href\", \"#\");\n  $(unblockButton).appendTo($(sessionDiv));\n  var blockButton = document.createElement(\"a\");\n  $(blockButton).addClass(\"btn \" + daButtonStyle + \"danger daobservebutton\");\n  if (obj.blocked) {\n    $(blockButton).addClass(\"dainvisible\");\n  }\n  $(blockButton).html(daBlockWord);\n  $(blockButton).attr(\"href\", \"#\");\n  $(blockButton).data(\"name\", \"block\");\n  $(blockButton).appendTo($(sessionDiv));\n  $(blockButton).click(function (e) {\n    $(unblockButton).removeClass(\"dainvisible\");\n    $(this).addClass(\"dainvisible\");\n    daDeActivateChatArea(key);\n    daSocket.emit(\"block\", { key: key });\n    e.preventDefault();\n    return false;\n  });\n  $(unblockButton).click(function (e) {\n    $(blockButton).removeClass(\"dainvisible\");\n    $(this).addClass(\"dainvisible\");\n    daSocket.emit(\"unblock\", { key: key });\n    e.preventDefault();\n    return false;\n  });\n  var joinButton = document.createElement(\"a\");\n  $(joinButton).addClass(\"btn \" + daButtonStyle + \"warning daobservebutton\");\n  $(joinButton).html(daJoinWord);\n  $(joinButton).attr(\n    \"href\",\n    daVisitInterviewUrl +\n      \"?\" +\n      $.param({ i: obj.i, uid: obj.uid, userid: obj.userid }),\n  );\n  $(joinButton).data(\"name\", \"join\");\n  $(joinButton).attr(\"target\", \"_blank\");\n  $(joinButton).appendTo($(sessionDiv));\n  if (wants_to_chat) {\n    var openButton = document.createElement(\"a\");\n    $(openButton).addClass(\"btn \" + daButtonStyle + \"primary daobservebutton\");\n    $(openButton).attr(\n      \"href\",\n      daObserverUrl +\n        \"?\" +\n        $.param({ i: obj.i, uid: obj.uid, userid: obj.userid }),\n    );\n    //$(openButton).attr('href', 'about:blank');\n    $(openButton).attr(\"id\", \"observe\" + key);\n    $(openButton).attr(\"target\", \"iframe\" + key);\n    $(openButton).html(daObserveWord);\n    $(openButton).data(\"name\", \"open\");\n    $(openButton).appendTo($(sessionDiv));\n    var stopObservingButton = document.createElement(\"a\");\n    $(stopObservingButton).addClass(\n      \"btn \" + daButtonStyle + \"secondary daobservebutton dainvisible\",\n    );\n    $(stopObservingButton).html(daStopObservingWord);\n    $(stopObservingButton).attr(\"href\", \"#\");\n    $(stopObservingButton).data(\"name\", \"stopObserving\");\n    $(stopObservingButton).appendTo($(sessionDiv));\n    var controlButton = document.createElement(\"a\");\n    $(controlButton).addClass(\"btn \" + daButtonStyle + \"info daobservebutton\");\n    $(controlButton).html(daControlWord);\n    $(controlButton).attr(\"href\", \"#\");\n    $(controlButton).data(\"name\", \"control\");\n    $(controlButton).appendTo($(sessionDiv));\n    var stopControllingButton = document.createElement(\"a\");\n    $(stopControllingButton).addClass(\n      \"btn \" + daButtonStyle + \"secondary daobservebutton dainvisible\",\n    );\n    $(stopControllingButton).html(daStopControllingWord);\n    $(stopControllingButton).attr(\"href\", \"#\");\n    $(stopControllingButton).data(\"name\", \"stopcontrolling\");\n    $(stopControllingButton).appendTo($(sessionDiv));\n    $(controlButton).click(function (event) {\n      event.preventDefault();\n      //console.log(\"Controlling...\");\n      $(this).addClass(\"dainvisible\");\n      $(stopControllingButton).removeClass(\"dainvisible\");\n      $(stopObservingButton).addClass(\"dainvisible\");\n      var theIframe = $(\"#iframe\" + skey).find(\"iframe\")[0];\n      if (theIframe != null && theIframe.contentWindow) {\n        theIframe.contentWindow.daTurnOnControl();\n      } else {\n        console.log(\"Cannot turn on control\");\n      }\n      daControlling[key] = 1;\n      return false;\n    });\n    $(stopControllingButton).click(function (event) {\n      //console.log(\"Got click on stopControllingButton\");\n      event.preventDefault();\n      var theIframe = $(\"#iframe\" + skey).find(\"iframe\")[0];\n      if (\n        theIframe != null &&\n        theIframe.contentWindow &&\n        theIframe.contentWindow.daTurnOffControl\n      ) {\n        theIframe.contentWindow.daTurnOffControl();\n      } else {\n        console.log(\"Cannot turn off control\");\n        return false;\n      }\n      //console.log(\"Stop controlling...\");\n      $(this).addClass(\"dainvisible\");\n      $(controlButton).removeClass(\"dainvisible\");\n      $(stopObservingButton).removeClass(\"dainvisible\");\n      if (daControlling.hasOwnProperty(key)) {\n        delete daControlling[key];\n      }\n      return false;\n    });\n    $(openButton).click(function (event) {\n      //console.log(\"Observing..\");\n      $(this).addClass(\"dainvisible\");\n      $(stopObservingButton).removeClass(\"dainvisible\");\n      $(\"#iframe\" + skey).removeClass(\"dainvisible\");\n      $(controlButton).removeClass(\"dainvisible\");\n      return true;\n    });\n    $(stopObservingButton).click(function (e) {\n      //console.log(\"Unobserving...\");\n      $(this).addClass(\"dainvisible\");\n      $(openButton).removeClass(\"dainvisible\");\n      $(controlButton).addClass(\"dainvisible\");\n      $(stopObservingButton).addClass(\"dainvisible\");\n      $(stopControllingButton).addClass(\"dainvisible\");\n      var theIframe = $(\"#iframe\" + skey).find(\"iframe\")[0];\n      if (daControlling.hasOwnProperty(key)) {\n        delete daControlling[key];\n        if (\n          theIframe != null &&\n          theIframe.contentWindow &&\n          theIframe.contentWindow.daTurnOffControl\n        ) {\n          //console.log(\"Calling daTurnOffControl in iframe\");\n          theIframe.contentWindow.daTurnOffControl();\n        }\n      }\n      if (theIframe != null && theIframe.contentWindow) {\n        //console.log(\"Deleting the iframe\");\n        theIframe.contentWindow.document.open();\n        theIframe.contentWindow.document.write(\"\");\n        theIframe.contentWindow.document.close();\n      }\n      $(\"#iframe\" + skey).slideUp(400, function () {\n        $(this).css(\"display\", \"\").addClass(\"dainvisible\");\n      });\n      e.preventDefault();\n      return false;\n    });\n    if ($(theIframeContainer).hasClass(\"dainvisible\")) {\n      $(openButton).removeClass(\"dainvisible\");\n      $(stopObservingButton).addClass(\"dainvisible\");\n      $(controlButton).addClass(\"dainvisible\");\n      $(stopControllingButton).addClass(\"dainvisible\");\n      if (daControlling.hasOwnProperty(key)) {\n        delete daControlling[key];\n      }\n    } else {\n      $(openButton).addClass(\"dainvisible\");\n      if (daControlling.hasOwnProperty(key)) {\n        $(stopObservingButton).addClass(\"dainvisible\");\n        $(controlButton).addClass(\"dainvisible\");\n        $(stopControllingButton).removeClass(\"dainvisible\");\n      } else {\n        $(stopObservingButton).removeClass(\"dainvisible\");\n        $(controlButton).removeClass(\"dainvisible\");\n        $(stopControllingButton).addClass(\"dainvisible\");\n      }\n    }\n  }\n  $(theText).appendTo($(sessionDiv));\n  if (\n    obj.chatstatus == \"on\" &&\n    key in daChatPartners &&\n    $(\"#chatarea\" + skey).hasClass(\"dainvisible\")\n  ) {\n    daActivateChatArea(key);\n  }\n  if (\n    (obj.chatstatus != \"on\" || !(key in daChatPartners)) &&\n    $(\"#chatarea\" + skey)\n      .find(\"button\")\n      .first()\n      .prop(\"disabled\") == false\n  ) {\n    daDeActivateChatArea(key);\n  } else if (obj.blocked) {\n    daDeActivateChatArea(key);\n  }\n}\nfunction daOnScrollResize() {\n  if (document.title != daBrowserTitle) {\n    document.title = daBrowserTitle;\n    daFaviconRegular();\n  }\n  if (!daShowingNotif) {\n    return true;\n  }\n  var obj = Array();\n  for (var key in daUpdatedSessions) {\n    if (daUpdatedSessions.hasOwnProperty(key)) {\n      obj.push(key);\n    }\n  }\n  var somethingAbove = false;\n  var somethingBelow = false;\n  var firstElement = -1;\n  var lastElement = -1;\n  for (var i = 0; i < obj.length; ++i) {\n    var result = daIsHidden(obj[i]);\n    if (result == 0) {\n      delete daUpdatedSessions[obj[i]];\n    } else if (result < 0) {\n      var top = $(obj[i]).offset().top;\n      somethingAbove = true;\n      if (firstElement == -1 || top < firstElement) {\n        firstElement = top;\n      }\n    } else if (result > 0) {\n      var top = $(obj[i]).offset().top;\n      somethingBelow = true;\n      if (lastElement == -1 || top > lastElement) {\n        lastElement = top;\n      }\n    }\n  }\n  if ($(\"#chat-message-above\").is(\":visible\") && !somethingAbove) {\n    $(\"#chat-message-above\").hide();\n  }\n  if ($(\"#chat-message-below\").is(\":visible\") && !somethingBelow) {\n    $(\"#chat-message-below\").hide();\n  }\n  if (!(somethingAbove || somethingBelow)) {\n    daShowingNotif = false;\n  }\n  return true;\n}\nfunction daReadyFunction() {\n  //console.log(\"document ready\");\n  try {\n    window.AudioContext = window.AudioContext || window.webkitAudioContext;\n    daAudioContext = new AudioContext();\n  } catch (e) {\n    console.log(\"Web Audio API is not supported in this browser\");\n  }\n  daLoadSoundBuffer(\n    \"newmessage\",\n    daNotificationClickOnMp3,\n    daNotificationClickOnOgg,\n  );\n  daLoadSoundBuffer(\n    \"newconversation\",\n    daNotificationStaplerMp3,\n    daNotificationStaplerOgg,\n  );\n  daLoadSoundBuffer(\"signinout\", daNotificationSnapMp3, daNotificationSnapOgg);\n  if (location.protocol === \"http:\" || document.location.protocol === \"http:\") {\n    daSocket = io.connect(\"http://\" + document.domain + \"/monitor\", {\n      path: daRootUrl + \"ws/socket.io\",\n    });\n  }\n  if (\n    location.protocol === \"https:\" ||\n    document.location.protocol === \"https:\"\n  ) {\n    daSocket = io.connect(\"https://\" + document.domain + \"/monitor\", {\n      path: daRootUrl + \"ws/socket.io\",\n    });\n  }\n  //console.log(\"socket is \" + daSocket)\n  if (typeof daSocket !== \"undefined\") {\n    daSocket.on(\"connect\", function () {\n      //console.log(\"Connected!\");\n      daUpdateMonitor();\n    });\n    daSocket.on(\"terminate\", function () {\n      console.log(\"monitor: terminating socket\");\n      daSocket.disconnect();\n    });\n    daSocket.on(\"disconnect\", function () {\n      //console.log(\"monitor: disconnected socket\");\n      //daSocket = null;\n    });\n    daSocket.on(\"refreshsessions\", function (data) {\n      daUpdateMonitor();\n    });\n    // daSocket.on('abortcontroller', function(data) {\n    //     console.log(\"Got abortcontroller message for \" + data.key);\n    // });\n    daSocket.on(\"chatready\", function (data) {\n      var key =\n        \"da:session:uid:\" +\n        data.uid +\n        \":i:\" +\n        data.i +\n        \":userid:\" +\n        data.userid;\n      //console.log('chatready: ' + key);\n      daActivateChatArea(key);\n      daNotifyOperator(key, \"chatready\", daNewChatConnection + \" \" + data.name);\n    });\n    daSocket.on(\"chatstop\", function (data) {\n      var key =\n        \"da:session:uid:\" +\n        data.uid +\n        \":i:\" +\n        data.i +\n        \":userid:\" +\n        data.userid;\n      //console.log('chatstop: ' + key);\n      if (key in daChatPartners) {\n        delete daChatPartners[key];\n      }\n      daDeActivateChatArea(key);\n    });\n    daSocket.on(\"chat_log\", function (arg) {\n      //console.log('chat_log: ' + arg.userid);\n      daPublishChatLog(\n        arg.uid,\n        arg.i,\n        arg.userid,\n        arg.mode,\n        arg.data,\n        arg.scroll,\n      );\n    });\n    daSocket.on(\"block\", function (arg) {\n      //console.log(\"back from blocking \" + arg.key);\n      daUpdateMonitor();\n    });\n    daSocket.on(\"unblock\", function (arg) {\n      //console.log(\"back from unblocking \" + arg.key);\n      daUpdateMonitor();\n    });\n    daSocket.on(\"chatmessage\", function (data) {\n      //console.log(\"chatmessage\");\n      var keys;\n      if (data.data.mode == \"peer\" || data.data.mode == \"peerhelp\") {\n        keys = daAllSessions(data.uid, data.i);\n      } else {\n        keys = [\n          \"da:session:uid:\" +\n            data.uid +\n            \":i:\" +\n            data.i +\n            \":userid:\" +\n            data.userid,\n        ];\n      }\n      for (var i = 0; i < keys.length; ++i) {\n        key = keys[i];\n        var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/)/g, \"\\\\$1\");\n        //console.log(\"Received chat message for #chatarea\" + skey);\n        var chatArea = $(\"#chatarea\" + skey)\n          .find(\"ul\")\n          .first();\n        var newLi = document.createElement(\"li\");\n        $(newLi).addClass(\"list-group-item\");\n        if (data.data.is_self) {\n          $(newLi).addClass(\"list-group-item-primary dalistright\");\n        } else {\n          $(newLi).addClass(\"list-group-item-secondary dalistleft\");\n        }\n        $(newLi).html(data.data.message);\n        $(newLi).appendTo(chatArea);\n        daScrollChat(\"#chatarea\" + skey);\n        if (data.data.is_self) {\n          $(\"#listelement\" + skey).removeClass(\"da-new-message\");\n          if (document.title != daBrowserTitle) {\n            document.title = daBrowserTitle;\n            daFaviconRegular();\n          }\n        } else {\n          if (\n            !$(\"#chatarea\" + skey)\n              .find(\"input\")\n              .first()\n              .is(\":focus\")\n          ) {\n            $(\"#listelement\" + skey).addClass(\"da-new-message\");\n            if (daBrowserTitle == document.title) {\n              document.title = \"* \" + daBrowserTitle;\n              daFaviconAlert();\n            }\n          }\n          if (data.data.hasOwnProperty(\"temp_user_id\")) {\n            daNotifyOperator(\n              key,\n              \"chat\",\n              daAnonymousVisitor +\n                \" \" +\n                data.data.temp_user_id +\n                \": \" +\n                data.data.message,\n            );\n          } else {\n            if (data.data.first_name && data.data.first_name != \"\") {\n              daNotifyOperator(\n                key,\n                \"chat\",\n                data.data.first_name +\n                  \" \" +\n                  data.data.last_name +\n                  \": \" +\n                  data.data.message,\n              );\n            } else {\n              daNotifyOperator(\n                key,\n                \"chat\",\n                data.data.email + \": \" + data.data.message,\n              );\n            }\n          }\n        }\n      }\n    });\n    daSocket.on(\"sessionupdate\", function (data) {\n      //console.log(\"Got session update: \" + data.session.chatstatus);\n      daDrawSession(data.key, data.session);\n      daCheckIfEmpty();\n    });\n    daSocket.on(\"updatemonitor\", function (data) {\n      //console.log(\"Got update monitor response\");\n      //console.log(\"updatemonitor: chat partners are: \" + data.chatPartners);\n      daChatPartners = data.chatPartners;\n      daNewPhonePartners = Object();\n      daTermPhonePartners = Object();\n      daPhonePartners = data.phonePartners;\n      var newSubscribedRoles = Object();\n      for (var key in data.subscribedRoles) {\n        if (data.subscribedRoles.hasOwnProperty(key)) {\n          newSubscribedRoles[key] = 1;\n        }\n      }\n      for (var i = 0; i < data.availRoles.length; ++i) {\n        var key = data.availRoles[i];\n        var skey = key.replace(/(:|\\.|\\[|\\]|,|=|\\/| )/g, \"\\\\$1\");\n        if ($(\"#role\" + skey).length == 0) {\n          var div = document.createElement(\"div\");\n          $(div).addClass(\"form-check form-check-inline\");\n          var label = document.createElement(\"label\");\n          $(label).addClass(\"form-check-label\");\n          $(label).attr(\"for\", \"role\" + key);\n          var input = document.createElement(\"input\");\n          $(input).addClass(\"form-check-input\");\n          var text = document.createTextNode(key);\n          $(input).attr(\"type\", \"checkbox\");\n          $(input).attr(\"id\", \"role\" + key);\n          if (key in newSubscribedRoles) {\n            $(input).prop(\"checked\", true);\n          } else {\n            $(input).prop(\"checked\", false);\n          }\n          $(input).val(key);\n          $(text).appendTo($(label));\n          $(input).appendTo($(div));\n          $(label).appendTo($(div));\n          $(div).appendTo($(\"#monitorroles\"));\n          $(input).change(function () {\n            var key = $(this).val();\n            //console.log(\"change to \" + key);\n            if ($(this).is(\":checked\")) {\n              //console.log(\"it is checked\");\n              daSubscribedRoles[key] = 1;\n            } else {\n              //console.log(\"it is not checked\");\n              if (key in daSubscribedRoles) {\n                delete daSubscribedRoles[key];\n              }\n            }\n            daUpdateMonitor();\n          });\n        } else {\n          var input = $(\"#role\" + skey).first();\n          if (key in newSubscribedRoles) {\n            $(input).prop(\"checked\", true);\n          } else {\n            $(input).prop(\"checked\", false);\n          }\n        }\n      }\n      daSubscribedRoles = newSubscribedRoles;\n      newDaSessions = Object();\n      for (var key in data.sessions) {\n        if (data.sessions.hasOwnProperty(key)) {\n          var user_id = key.replace(/^.*:userid:/, \"\");\n          if (true || user_id != daUserid) {\n            var obj = data.sessions[key];\n            newDaSessions[key] = obj;\n            daDrawSession(key, obj);\n          }\n        }\n      }\n      var toDelete = Array();\n      var numSessions = 0;\n      for (var key in daSessions) {\n        if (daSessions.hasOwnProperty(key)) {\n          numSessions++;\n          if (!(key in newDaSessions)) {\n            toDelete.push(key);\n          }\n        }\n      }\n      for (var i = 0; i < toDelete.length; ++i) {\n        var key = toDelete[i];\n        daUndrawSession(key);\n      }\n      if ($(\"#monitorsessions\").find(\"li\").length > 0) {\n        $(\"#emptylist\").addClass(\"dainvisible\");\n      } else {\n        $(\"#emptylist\").removeClass(\"dainvisible\");\n      }\n    });\n  }\n  if (daAvailableForChat) {\n    $(\"#daNotAvailable\").addClass(\"dainvisible\");\n    daCheckNotifications();\n  } else {\n    $(\"#daAvailable\").addClass(\"dainvisible\");\n  }\n  $(\"#daAvailable\").click(function (event) {\n    $(\"#daAvailable\").addClass(\"dainvisible\");\n    $(\"#daNotAvailable\").removeClass(\"dainvisible\");\n    daAvailableForChat = false;\n    //console.log(\"daAvailableForChat: \" + daAvailableForChat);\n    daUpdateMonitor();\n    daPlaySound(\"signinout\");\n  });\n  $(\"#daNotAvailable\").click(function (event) {\n    daCheckNotifications();\n    $(\"#daNotAvailable\").addClass(\"dainvisible\");\n    $(\"#daAvailable\").removeClass(\"dainvisible\");\n    daAvailableForChat = true;\n    //console.log(\"daAvailableForChat: \" + daAvailableForChat);\n    daUpdateMonitor();\n    daPlaySound(\"signinout\");\n  });\n  $(window).bind(\"unload\", function () {\n    if (typeof daSocket !== \"undefined\") {\n      daSocket.emit(\"terminate\");\n    }\n  });\n  if (daUsePhone) {\n    $(\"#daPhoneInfo\").removeClass(\"dainvisible\");\n    $(\"#daPhoneNumber\").val(daPhoneNumber);\n    $(\"#daPhoneNumber\").change(daCheckPhone);\n    $(\"#daPhoneNumber\").bind(\"keypress keydown keyup\", function (e) {\n      var theCode = e.which || e.keyCode;\n      if (theCode == 13) {\n        $(this).blur();\n        e.preventDefault();\n      }\n    });\n  }\n  $(window).on(\"scroll\", daOnScrollResize);\n  $(window).on(\"resize\", daOnScrollResize);\n  $(\".da-chat-notifier\").click(function (e) {\n    //var key = $(this).data('key');\n    var direction = 0;\n    if ($(this).attr(\"id\") == \"chat-message-above\") {\n      direction = -1;\n    } else {\n      direction = 1;\n    }\n    var target = -1;\n    var targetElement = null;\n    for (var key in daUpdatedSessions) {\n      if (daUpdatedSessions.hasOwnProperty(key)) {\n        var top = $(key).offset().top;\n        if (direction == -1) {\n          if (target == -1 || top < target) {\n            target = top;\n            targetElement = key;\n          }\n        } else {\n          if (target == -1 || top > target) {\n            target = top;\n            targetElement = key;\n          }\n        }\n      }\n    }\n    if (target >= 0) {\n      $(\"html, body\").animate({ scrollTop: target - 60 }, 500, function () {\n        $(targetElement).find(\"input\").first().focus();\n      });\n    }\n    e.preventDefault();\n    return false;\n  });\n}\n"],"names":["$","document","addEventListener","jQuery","noConflict","ready","daReadyFunction","daAudioContext","daSocket","daSoundBuffer","Object","daShowingNotif","daUpdatedSessions","daSessions","daAvailRoles","daChatPartners","daPhonePartners","daNewPhonePartners","daTermPhonePartners","daFirstTime","daUpdateMonitorInterval","daNotificationsEnabled","daControlling","window","daGotConfirmation","key","daFaviconRegular","link","querySelector","createElement","type","rel","href","daFaviconIcoUrl","getElementsByTagName","appendChild","daFaviconAlert","daChatIcoUrl","daTopMessage","message","newDiv","addClass","html","css","appendTo","daTargetDiv","slideDown","setTimeout","slideUp","remove","daAbortControlling","daAlreadyControlled","daStopControlling","skey","replace","find","each","this","data","click","daOnError","console","log","daLoadSoundBuffer","url_a","url_b","pos","request","XMLHttpRequest","open","responseType","onload","decodeAudioData","response","buffer","error","info","send","daPlaySound","source","createBufferSource","connect","destination","start","daCheckNotifications","Notification","permission","requestPermission","daNotifyOperator","mode","offset","top","scrollTop","height","daNewMessageBelow","daNewConversationBelow","daMarkAsUpdated","daNewMessageAbove","daNewConversationAbove","notification","daPhoneNumberOk","phoneNumber","val","match","daCheckPhone","the_number","removeClass","daPhoneNumber","daAllSessions","uid","yaml_filename","prefix","output","Array","hasOwnProperty","indexOf","push","daScrollChat","chatScroller","first","length","scrollHeight","animate","daScrollChatFast","daDoUpdateMonitor","emit","available_for_chat","daAvailableForChat","phone_number","subscribed_roles","daSubscribedRoles","phone_partners_to_add","phone_partners_to_terminate","daUpdateMonitor","clearInterval","setInterval","daCheckinInterval","daIsHidden","ref","daActivateChatArea","is","daBrowserTitle","title","prop","daDeActivateChatArea","daUndrawSession","xButton","xButtonIcon","daOfflineWord","daButtonStyle","daCheckIfEmpty","theIframe","contents","contentWindow","daTurnOffControl","daPublishChatLog","userid","messages","scroll","keys","i","chatArea","newLi","is_self","daDrawSession","obj","the_html","wants_to_chat","chatstatus","browser_title","first_name","last_name","daAnonymousVisitor","temp_user_id","theListElement","sessionDiv","theIframeContainer","theChatArea","empty","attr","daSendWord","submitter","input","trim","bind","e","theCode","which","keyCode","preventDefault","focus","theText","innerHTML","statusLabel","daUsePhone","phoneButton","phoneIcon","daPhoneOnMessage","daPhoneOffMessage","hasClass","unblockButton","blocked","daUnblockWord","blockButton","daBlockWord","joinButton","daJoinWord","daVisitInterviewUrl","param","openButton","daObserverUrl","daObserveWord","stopObservingButton","daStopObservingWord","controlButton","daControlWord","stopControllingButton","daStopControllingWord","event","daTurnOnControl","write","close","daOnScrollResize","somethingAbove","somethingBelow","firstElement","lastElement","result","hide","AudioContext","webkitAudioContext","daNotificationClickOnMp3","daNotificationClickOnOgg","daNotificationStaplerMp3","daNotificationStaplerOgg","daNotificationSnapMp3","daNotificationSnapOgg","location","protocol","io","domain","path","daRootUrl","on","disconnect","daNewChatConnection","name","arg","email","session","chatPartners","phonePartners","newSubscribedRoles","subscribedRoles","availRoles","div","label","text","createTextNode","change","newDaSessions","sessions","user_id","daUserid","toDelete","numSessions","blur","direction","target","targetElement"],"mappings":"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"}